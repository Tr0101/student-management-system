{% extends 'base.html' %}
{% block title %}Báº£ng Ä‘iá»u khiá»ƒn{% endblock %}
{% block content %}

<h2 class="fw-semibold mb-4 text-dark">ğŸ“ Sinh viÃªn quáº£n lÃ½ Báº£ng Ä‘iá»u khiá»ƒn</h2>

<div class="row g-4 mb-4">

  <!-- Tá»•ng sinh viÃªn -->
  <div class="col-md-4">
    <div class="info-card">
      <div class="text-muted small">Tá»•ng sinh viÃªn</div>
      <div class="fs-1 fw-bold text-primary">{{ total_students }}</div>
    </div>
  </div>

  <!-- Tá»•ng mÃ´n há»c -->
  <div class="col-md-4">
    <div class="info-card">
      <div class="text-muted small">Tá»•ng mÃ´n há»c</div>
      <div class="fs-1 fw-bold text-success">{{ total_courses }}</div>
    </div>
  </div>

  <!-- Tá»•ng lÆ°á»£t ghi danh -->
  <div class="col-md-4">
    <div class="info-card">
      <div class="text-muted small">Sá»‘ lÆ°á»£t Ä‘Äƒng kÃ½ há»c</div>
      <div class="fs-1 fw-bold text-info">{{ total_enrollments }}</div>
    </div>
  </div>

</div>


<div class="row g-4">
  
  <!-- Biá»ƒu Ä‘á»“ phÃ¢n bá»‘ Ä‘iá»ƒm -->
  <div class="col-lg-7">
    <div class="p-4 bg-white shadow-sm rounded-4">
      <h6 class="fw-semibold mb-3">ğŸ“Š PhÃ¢n chia Ä‘iá»ƒm sinh viÃªn</h6>
      <canvas id="scoreChart"></canvas>
    </div>
  </div>

  <!-- Top 5 mÃ´n há»c -->
  <div class="col-lg-5">
    <div class="p-4 bg-white shadow-sm rounded-4">
      <h6 class="fw-semibold mb-3">ğŸ† Top 5 mÃ´n há»c Ä‘Æ°á»£c Ä‘Äƒng kÃ½ nhiá»u nháº¥t</h6>
      <table class="table table-sm align-middle">
        <thead class="table-light">
          <tr>
            <th>MÃ´n há»c</th>
            <th class="text-end">Sá»‘ lÆ°á»£t</th>
          </tr>
        </thead>
        <tbody>
          {% if top_courses %}
            {% for c, count in top_courses %}
            <tr>
              <td>{{ c }}</td>
              <td class="text-end fw-semibold">{{ count }}</td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="2" class="text-center text-muted">KhÃ´ng cÃ³ dá»¯ liá»‡u</td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>

</div>

<script>
  const scoreData = {{ score_distribution|tojson }};
  const ctx = document.getElementById('scoreChart').getContext('2d');

  new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['0-1','1-2','2-3','3-4','4-5','5-6','6-7','7-8','8-9','9-10'],
      datasets: [{
        data: scoreData,
        borderWidth: 3,
        tension: 0.35
      }]
    },
    options: {
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true } }
    }
  });
</script>

{% endblock %}
